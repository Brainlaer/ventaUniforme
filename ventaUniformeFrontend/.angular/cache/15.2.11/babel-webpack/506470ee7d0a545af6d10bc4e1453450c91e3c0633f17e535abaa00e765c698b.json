{"ast":null,"code":"import _asyncToGenerator from \"/home/bsvanegas/Documents/Workspace/deporte/ventaUniformeFrontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Observable } from 'rxjs';\nlet CarritoComponent = class CarritoComponent {\n  constructor(carritoService, personaService, reservaService, router) {\n    this.carritoService = carritoService;\n    this.personaService = personaService;\n    this.reservaService = reservaService;\n    this.router = router;\n    this.isDateMissing = false;\n    this.vestimentaList = this.carritoService.getVestimentas();\n    this.costo$ = new Observable();\n  }\n  ngOnInit() {\n    this.costo$ = this.carritoService.getTotal();\n  }\n  removeVestimenta(vestimentaItem) {\n    this.carritoService.removeVestimenta(vestimentaItem);\n  }\n  reservar() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      console.log(sessionStorage.getItem('token'));\n      let total;\n      yield _this.costo$.subscribe(totalGotten => total = totalGotten);\n      let persona;\n      let tallaDtoList = [];\n      yield _this.personaService.findByCorreo(String(sessionStorage.getItem('correoPersona'))).subscribe(personaGotten => {\n        persona = personaGotten.id;\n        console.log(persona);\n        if (persona != null) {\n          let reserva = {\n            idPersona: persona,\n            tallaDtoList: tallaDtoList,\n            total: total,\n            fechaEntrega: _this.fechaEntrega\n          };\n          _this.vestimentaList.forEach(item => {\n            item.vestimenta.talla.vestimentaId = item.vestimenta.id;\n            item.vestimenta.talla.unidades = item.vestimenta.unidadesVestimenta;\n            tallaDtoList.push(item.vestimenta.talla);\n          });\n          console.log(reserva);\n          _this.reservaService.reservar(reserva).subscribe(response => {\n            console.log(response);\n          }, error => {\n            if (error.status == 403) {\n              sessionStorage.removeItem('token');\n              sessionStorage.removeItem('isLoggin');\n              _this.router.navigateByUrl('/inicio-session');\n            }\n            console.log(error);\n          });\n        }\n      });\n    })();\n  }\n};\nCarritoComponent = __decorate([Component({\n  selector: 'app-carrito',\n  templateUrl: './carrito.component.html',\n  styleUrls: ['./carrito.component.css']\n})], CarritoComponent);\nexport { CarritoComponent };","map":{"version":3,"mappings":";;AAAA,SAASA,SAAS,QAAgB,eAAe;AAEjD,SAASC,UAAU,QAAQ,MAAM;AAW1B,IAAMC,gBAAgB,GAAtB,MAAMA,gBAAgB;EAI3BC,YACUC,cAA6B,EAC7BC,cAA6B,EAC7BC,cAA6B,EAC7BC,MAAa;IAHb,mBAAc,GAAdH,cAAc;IACd,mBAAc,GAAdC,cAAc;IACd,mBAAc,GAAdC,cAAc;IACd,WAAM,GAANC,MAAM;IANhB,kBAAa,GAAS,KAAK;IAgB3B,mBAAc,GAAO,IAAI,CAACH,cAAc,CAACI,cAAc,EAAE;IACzD,WAAM,GAAoB,IAAIP,UAAU,EAAE;EAR1C;EAEAQ,QAAQ;IACN,IAAI,CAACC,MAAM,GAAG,IAAI,CAACN,cAAc,CAACO,QAAQ,EAAE;EAC9C;EAMAC,gBAAgB,CAACC,cAAkB;IACjC,IAAI,CAACT,cAAc,CAACQ,gBAAgB,CAACC,cAAc,CAAC;EACtD;EAEMC,QAAQ;IAAA;IAAA;MACZC,OAAO,CAACC,GAAG,CAACC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;MAC5C,IAAIC,KAAS;MACb,MAAM,KAAI,CAACT,MAAM,CAACU,SAAS,CAAEC,WAAkB,IAAIF,KAAK,GAACE,WAAY,CAAC;MACtE,IAAIC,OAAc;MAClB,IAAIC,YAAY,GAAO,EAAE;MACxB,MAAM,KAAI,CAAClB,cAAc,CAACmB,YAAY,CAACC,MAAM,CAACR,cAAc,CAACC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,CAACE,SAAS,CAC/FM,aAAiB,IAAG;QACnBJ,OAAO,GAACI,aAAa,CAACC,EAAE;QACxBZ,OAAO,CAACC,GAAG,CAACM,OAAO,CAAC;QACpB,IAAGA,OAAO,IAAE,IAAI,EAAC;UACf,IAAIM,OAAO,GAAK;YACdC,SAAS,EAACP,OAAO;YACjBC,YAAY,EAACA,YAAY;YACzBJ,KAAK,EAACA,KAAK;YACXW,YAAY,EAAC,KAAI,CAACA;WACnB;UAED,KAAI,CAACC,cAAc,CAACC,OAAO,CAAEC,IAAQ,IAAG;YACtCA,IAAI,CAACC,UAAU,CAACC,KAAK,CAACC,YAAY,GAACH,IAAI,CAACC,UAAU,CAACP,EAAE;YACrDM,IAAI,CAACC,UAAU,CAACC,KAAK,CAACE,QAAQ,GAACJ,IAAI,CAACC,UAAU,CAACI,kBAAkB;YACjEf,YAAY,CAACgB,IAAI,CAACN,IAAI,CAACC,UAAU,CAACC,KAAK,CAAC;UAC1C,CAAC,CAAC;UACFpB,OAAO,CAACC,GAAG,CAACY,OAAO,CAAC;UACpB,KAAI,CAACtB,cAAc,CAACQ,QAAQ,CAACc,OAAO,CAAC,CAACR,SAAS,CAC5CoB,QAAY,IAAG;YACdzB,OAAO,CAACC,GAAG,CAACwB,QAAQ,CAAC;UACvB,CAAC,EAAEC,KAAK,IAAG;YACT,IAAGA,KAAK,CAACC,MAAM,IAAE,GAAG,EAAC;cACnBzB,cAAc,CAAC0B,UAAU,CAAC,OAAO,CAAC;cAClC1B,cAAc,CAAC0B,UAAU,CAAC,UAAU,CAAC;cACrC,KAAI,CAACpC,MAAM,CAACqC,aAAa,CAAC,iBAAiB,CAAC;;YAE9C7B,OAAO,CAACC,GAAG,CAACyB,KAAK,CAAC;UACpB,CAAC,CACF;;MAIL,CAAC,CACF;IAAA;EAEH;CAMD;AAzEYvC,gBAAgB,eAL5BF,SAAS,CAAC;EACT6C,QAAQ,EAAE,aAAa;EACvBC,WAAW,EAAE,0BAA0B;EACvCC,SAAS,EAAE,CAAC,yBAAyB;CACtC,CAAC,GACW7C,gBAAgB,CAyE5B;SAzEYA,gBAAgB","names":["Component","Observable","CarritoComponent","constructor","carritoService","personaService","reservaService","router","getVestimentas","ngOnInit","costo$","getTotal","removeVestimenta","vestimentaItem","reservar","console","log","sessionStorage","getItem","total","subscribe","totalGotten","persona","tallaDtoList","findByCorreo","String","personaGotten","id","reserva","idPersona","fechaEntrega","vestimentaList","forEach","item","vestimenta","talla","vestimentaId","unidades","unidadesVestimenta","push","response","error","status","removeItem","navigateByUrl","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/home/bsvanegas/Documents/Workspace/deporte/ventaUniformeFrontend/src/app/pages/carrito/carrito.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { AuthService } from 'src/app/services/auth/auth.service';\nimport { CarritoService } from 'src/app/services/carrito/carrito.service';\nimport { PersonaService } from 'src/app/services/persona.service';\nimport { ReservaService } from 'src/app/services/reserva/reserva.service';\n\n@Component({\n  selector: 'app-carrito',\n  templateUrl: './carrito.component.html',\n  styleUrls: ['./carrito.component.css']\n})\nexport class CarritoComponent implements OnInit {\n\n  isDateMissing:boolean=false;\n\n  constructor(\n    private carritoService:CarritoService,\n    private personaService:PersonaService,\n    private reservaService:ReservaService,\n    private router:Router\n\n  ){\n  }\n\n  ngOnInit(): void {\n    this.costo$ = this.carritoService.getTotal();\n  }\n\n  fechaEntrega!:Date;\n  vestimentaList:any[]=this.carritoService.getVestimentas();\n  costo$:Observable<number>=new Observable();\n\n  removeVestimenta(vestimentaItem:any){\n    this.carritoService.removeVestimenta(vestimentaItem);\n  }\n\n  async reservar(){\n    console.log(sessionStorage.getItem('token'));\n    let total:any;\n    await this.costo$.subscribe((totalGotten:number)=>(total=totalGotten));\n    let persona:string;\n    let tallaDtoList:any[]=[];\n     await this.personaService.findByCorreo(String(sessionStorage.getItem('correoPersona'))).subscribe(\n      (personaGotten:any)=>{\n        persona=personaGotten.id;\n        console.log(persona);\n        if(persona!=null){\n          let reserva:any={\n            idPersona:persona,\n            tallaDtoList:tallaDtoList,\n            total:total,\n            fechaEntrega:this.fechaEntrega\n          }\n          \n          this.vestimentaList.forEach((item:any)=>{\n            item.vestimenta.talla.vestimentaId=item.vestimenta.id;\n            item.vestimenta.talla.unidades=item.vestimenta.unidadesVestimenta;\n            tallaDtoList.push(item.vestimenta.talla);\n          })\n          console.log(reserva);\n          this.reservaService.reservar(reserva).subscribe(\n            (response:any)=>{\n              console.log(response);\n            },(error)=>{\n              if(error.status==403){\n                sessionStorage.removeItem('token');\n                sessionStorage.removeItem('isLoggin');\n                this.router.navigateByUrl('/inicio-session');\n              }\n              console.log(error);\n            }\n          );\n\n        }\n\n      }\n    )\n    \n  }\n\n\n\n\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}